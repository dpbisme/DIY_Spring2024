# Overview of this repo

> This repo houses all of the R code, metadata, and ancillary files for the manuscript [Selective whole-genome amplification reveals population genetics of Leishmania braziliensis directly from patient skin biopsies](). All SWGA sequencing data are publicly-available on the Sequence Read Archive (SRA) under the study accession numbers [PRJNA875085](https://www.ncbi.nlm.nih.gov/sra/?term=PRJNA875085). The abstract for the manuscript is copied below:

# Abstract

> In Brazil, Leishmania braziliensis is the main causative agent of the neglected tropical disease, cutaneous leishmaniasis (CL).  CL caused by L. braziliensis can present on a spectrum of disease severity with high rate of treatment failure. Yet the parasite factors that may contribute to disease presentation and treatment outcome are not well understood, in part because successfully isolating and culturing parasites from patient lesions remains a major technical challenge.  Here we describe the development of selective whole genome amplification (SWGA) for Leishmania and show that this method enables culture-independent analysis of parasite genomes obtained directly from primary patient skin samples, allowing us to circumvent artifacts associated with adaptation to culture. We show that SWGA can be applied to multiple Leishmania species residing in different host species, suggesting that this method is broadly useful in both experimental infection models and clinical studies. Finally, we show that parasite genome sequencing data generated by SWGA of skin biopsies collected from patients in Corte de Pedra, Bahia, Brazil exhibit substantial genetic diversity and can be integrated with published whole genome data from parasite isolates to identify variants associated with high treatment failure rates observed in Northeast Brazil.  

# Directory listing

- **/code** - contains all code used to produce all primary and supplementary figures from the manuscript. Note, neither of the shell scripts below are run as part of this code capsule, however they are provided here for reproducibility.
    - */code/SWGA_analysis_script.R* - This is the main R script for analysis of the SWGA data.  This script reproduces Figures 2C, 2D, 3A-D, 5C, 5D, and Supplementary Figure 1.
    - */code/snpEff_workflow_SWGA.sh* - This shell script runs all snpEff and snpSift functions used to annotate and filter variants in the publication.  This script was used to generate the data underlying Figure 6 of the manuscript.
    - */code/snpEff.config* - This file is used to configure snpEff for use on the *L. braziliensis* reference genome
    - */code/run* - When the capsule is executed, this script will run the shell script and the R script above in succession. 


- **/data** - contains all data inputs for the scripts above, including QIIME objects, metadata, and tables
    - */data/Leishmania_59genomes.microreact* - This file can be loaded into [Microreact](https://microreact.org/) to reproduce the maps and phylogenetic tree shown in Figure 5 of the manuscript.
    - */data/Lbraz* - this directory contains reference *L. braziliensis* genome files used for configuration of snpEff.
    - */data/patient.controls.genotyped.freebayes.gatk.union.biallelic.vcf* - this VCF file contains variants detected in spike-in controls, WGS, and SWGA samples.  This file is used in the R script above.
    - */data/29159.cov.100.header.bed* - this is the .bed file for patient 29159, which is necessary to produce coverage plots shown in Figures 2C and 2D.
    - */data/WGS.Leish_Nextera.cov.100.header.bed* - this is the .bed file for WGS, which is necessary to produce coverage plots shown in Figures 2C and 2D.
    - */data/Genome_Cov.Table* - Simple two column text file containing genome coverage data for each of the 18 SWGA genomes.
    - */data/Genome_Cov.Table.control* - Simple two column text file containing genome coverage data for each of the control samples used in the manuscript. 
    - */data/Lbraz_SWGA_variants/* - this directory contains the vcf for analysis in the shell script above.
    - */data/GOenrich.txt* - Tab-delimited text file containing Gene Ontology Molecular Function (GO MF) enrichment results obtained from [TriTrypDB.org](https://tritrypdb.org/).  This file is used as input to produce Figure 6B in the manuscript.


```



